<!doctype html>
<html lang="en">
<head>
	<title>Shapes (Three.js)</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<link rel=stylesheet href="css/base.css"/>
</head>
<body>

<script src="js/Three.js"></script>
<script src="js/OrbitControls.js"></script>
<script src="js/threex.fullscreen.js"></script>
<script src="js/threex.windowresize.js"></script>
<script src='js/threex.domevents.js'></script>
<script src='js/threex.text.js'></script>
<script src="js/droid_serif_bold.typeface.js"></script>

<div id="ThreeJS" style="position: absolute; left:0px; top:0px"></div>
<script>

var container, scene, camera, renderer, controls;

var score = 0;

init();
animate();

// FUNCTIONS
function init()
{

	// SCENE
	scene = new THREE.Scene();
	// CAMERA
	var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight;
	var VIEW_ANGLE = 50, ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT, NEAR = 0.1, FAR = 20000;
	camera = new THREE.PerspectiveCamera( VIEW_ANGLE, ASPECT, NEAR, FAR);
	scene.add(camera);
	camera.position.set(0,150,600);
	camera.lookAt(scene.position);
	// RENDERER
	renderer = new THREE.WebGLRenderer( {antialias:true} );
	renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
	renderer.shadowMapEnabled = true;
	container = document.getElementById( 'ThreeJS' );
	container.appendChild( renderer.domElement );
	// EVENTS
	THREEx.WindowResize(renderer, camera);
	// CONTROLS
	controls = new THREE.OrbitControls( camera, renderer.domElement );
	// LIGHT
	var light = new THREE.PointLight(0xffffff);
	light.position.set(0,-50,0);
	scene.add(light);
	//spotlight #1 -- yellow, dark shadow
	var spotlight = new THREE.SpotLight(0xffff00);
	spotlight.position.set(-120,250,-60);
	//spotlight.shadowCameraVisible = true;
	spotlight.shadowDarkness = 0.95;
	spotlight.intensity = 5;
	// must enable shadow casting ability for the light
	spotlight.castShadow = true;
	scene.add(spotlight);

	// spotlight #2 -- red, light shadow
	var spotlight2 = new THREE.SpotLight(0xff0000);
	spotlight2.position.set(120,250,-60);
	scene.add(spotlight2);
	//spotlight2.shadowCameraVisible = true;
	spotlight2.shadowDarkness = 0.70;
	spotlight2.intensity = 2;
	spotlight2.castShadow = true;

	//spotlight front
	var spotlightFront = new THREE.SpotLight(0xffff00);
	spotlightFront.position.set(-120,250,200);
	//spotlightFront.shadowCameraVisible = true;
	spotlightFront.shadowDarkness = 0.95;
	spotlightFront.intensity = 5;
	// must enable shadow casting ability for the light
	spotlightFront.castShadow = true;
	scene.add(spotlightFront);

	// spotlight #2 front -- red, light shadow
	var spotlight2Front = new THREE.SpotLight(0xff0000);
	spotlight2Front.position.set(120,250,200);
	scene.add(spotlight2Front);
	//spotlight2Front.shadowCameraVisible = true;
	spotlight2Front.shadowDarkness = 0.70;
	spotlight2Front.intensity = 5;
	spotlight2Front.castShadow = true;

	// spotlight #3
	var spotlight3 = new THREE.SpotLight(0x0000ff);
	spotlight3.position.set(150,150,-100);
	//spotlight3.shadowCameraVisible = true;
	spotlight3.shadowDarkness = 0.95;
	spotlight3.intensity = 2;
	spotlight3.castShadow = true;
	scene.add(spotlight3);
	// change the direction this spotlight is facing
	var lightTarget = new THREE.Object3D();
	lightTarget.position.set(150,10,-100);
	scene.add(lightTarget);
	spotlight3.target = lightTarget;

	// SKYBOX/FOG
	var skyBoxGeometry = new THREE.CubeGeometry( 10000, 10000, 10000 );
	var skyBoxMaterial = new THREE.MeshBasicMaterial( { color: 0x9999ff, side: THREE.BackSide } );
	var skyBox = new THREE.Mesh( skyBoxGeometry, skyBoxMaterial );
	// scene.add(skyBox);
	scene.fog = new THREE.FogExp2( 0x9999ff, 0.00025 );


	// Using wireframe materials to illustrate shape details.
	var darkMaterial = new THREE.MeshLambertMaterial( { color: 0xff9b111e } );
	var wireframeMaterial = new THREE.MeshBasicMaterial( { color: 0x000000, wireframe: true, transparent: true } );
	var multiMaterial = [ darkMaterial, wireframeMaterial ];

	//clicking
	var domEvents   = new THREEx.DomEvents(camera, renderer.domElement)

	//////////////////////
	///Makes the Gems ///
	/////////////////////

	// Row 1 //
	var geometry1 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem1 = THREE.SceneUtils.createMultiMaterialObject(geometry1, multiMaterial );
		gem1.position.set(-200, 50, 100);
		scene.add( gem1 );

	var geometry2 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem2 = THREE.SceneUtils.createMultiMaterialObject(geometry2, multiMaterial );
		gem2.position.set(-100, 50, 100);
		scene.add( gem2 );

	var geometry3 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem3 = THREE.SceneUtils.createMultiMaterialObject(geometry3, multiMaterial );
		gem3.position.set(0, 50, 100);
		scene.add( gem3 );

	var geometry4 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem4 = THREE.SceneUtils.createMultiMaterialObject(geometry4, multiMaterial );
		gem4.position.set(100, 50, 100);
		scene.add( gem4 );

	var geometry5 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem5 = THREE.SceneUtils.createMultiMaterialObject(geometry5, multiMaterial );
		gem5.position.set(200, 50, 100);
		scene.add( gem5 );

	// ROW 2 //

	var geometry6 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem6 = THREE.SceneUtils.createMultiMaterialObject(geometry6, multiMaterial );
		gem6.position.set(-200, 50, 0);
		scene.add( gem6 );

	var geometry7 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem7 = THREE.SceneUtils.createMultiMaterialObject(geometry7, multiMaterial );
		gem7.position.set(-100, 50, 0);
		scene.add( gem7 );

	var geometry8 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem8 = THREE.SceneUtils.createMultiMaterialObject(geometry8, multiMaterial );
		gem8.position.set(0, 50, 0);
		scene.add( gem8 );

	var geometry9 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem9 = THREE.SceneUtils.createMultiMaterialObject(geometry9, multiMaterial );
		gem9.position.set(100, 50, 0);
		scene.add( gem9 );

	var geometry10 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem10 = THREE.SceneUtils.createMultiMaterialObject(geometry10, multiMaterial );
		gem10.position.set(200, 50, 0);
		scene.add( gem10 );

	// ROW 3 //

	var geometry11 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem11 = THREE.SceneUtils.createMultiMaterialObject(geometry11, multiMaterial );
		gem11.position.set(-200, 50, -100);
		scene.add( gem11 );

	var geometry12 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem12 = THREE.SceneUtils.createMultiMaterialObject(geometry12, multiMaterial );
		gem12.position.set(-100, 50, -100);
		scene.add( gem12 );

	var geometry13 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem13 = THREE.SceneUtils.createMultiMaterialObject(geometry13, multiMaterial );
		gem13.position.set(0, 50, -100);
		scene.add( gem13 );

	var geometry14 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem14 = THREE.SceneUtils.createMultiMaterialObject(geometry14, multiMaterial );
		gem14.position.set(100, 50, -100);
		scene.add( gem14 );

	var geometry15 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem15 = THREE.SceneUtils.createMultiMaterialObject(geometry15, multiMaterial );
		gem15.position.set(200, 50, -100);
		scene.add( gem15 );

	// ROW 4 //
	var geometry16 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem16 = THREE.SceneUtils.createMultiMaterialObject(geometry16, multiMaterial );
		gem16.position.set(-200, 50, -200);
		scene.add( gem16 );

	var geometry17 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem17 = THREE.SceneUtils.createMultiMaterialObject(geometry17, multiMaterial );
		gem17.position.set(-100, 50, -200);
		scene.add( gem17 );

	var geometry18 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem18 = THREE.SceneUtils.createMultiMaterialObject(geometry18, multiMaterial );
		gem18.position.set(0, 50, -200);
		scene.add( gem18 );

	var geometry19 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem19 = THREE.SceneUtils.createMultiMaterialObject(geometry19, multiMaterial );
		gem19.position.set(100, 50, -200);
		scene.add( gem19 );

	var geometry20 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem20 = THREE.SceneUtils.createMultiMaterialObject(geometry20, multiMaterial );
		gem20.position.set(200, 50, -200);
		scene.add( gem20 );

	//bottom-rows//
	//first-row
	var geometry21 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem21 = THREE.SceneUtils.createMultiMaterialObject(geometry21, multiMaterial );
		gem21.position.set(-200, -50, 100);
		scene.add( gem21 );

	var geometry22 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem22 = THREE.SceneUtils.createMultiMaterialObject(geometry22, multiMaterial );
		gem22.position.set(-100, -50, 100);
		scene.add( gem22 );

	var geometry23 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem23 = THREE.SceneUtils.createMultiMaterialObject(geometry23, multiMaterial );
		gem23.position.set(0, -50, 100);
		scene.add( gem23 );

	var geometry24 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem24 = THREE.SceneUtils.createMultiMaterialObject(geometry24, multiMaterial );
		gem24.position.set(100, -50, 100);
		scene.add( gem24 );

	var geometry25 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem25 = THREE.SceneUtils.createMultiMaterialObject(geometry25, multiMaterial );
		gem25.position.set(200, -50, 100);
		scene.add( gem25 );

	//2nd-row
	var geometry46 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem46 = THREE.SceneUtils.createMultiMaterialObject(geometry46, multiMaterial );
		gem46.position.set(-200, -50, 0);
		scene.add( gem46 );

	var geometry47 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem47 = THREE.SceneUtils.createMultiMaterialObject(geometry47, multiMaterial );
		gem47.position.set(-100, -50, 0);
		scene.add( gem47 );

	var geometry48 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem48 = THREE.SceneUtils.createMultiMaterialObject(geometry48, multiMaterial );
		gem48.position.set(0, -50, 0);
		scene.add( gem48 );

	var geometry49 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem49 = THREE.SceneUtils.createMultiMaterialObject(geometry49, multiMaterial );
		gem49.position.set(100, -50, 0);
		scene.add( gem49 );

	var geometry50 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem50 = THREE.SceneUtils.createMultiMaterialObject(geometry50, multiMaterial );
		gem50.position.set(200, -50, 0);
		scene.add( gem50 );

	//2nd-row
	var geometry51 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem51 = THREE.SceneUtils.createMultiMaterialObject(geometry51, multiMaterial );
		gem51.position.set(-200, -50, -100);
		scene.add( gem51 );

	var geometry52 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem52 = THREE.SceneUtils.createMultiMaterialObject(geometry52, multiMaterial );
		gem52.position.set(-100, -50, -100);
		scene.add( gem52 );

	var geometry53 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem53 = THREE.SceneUtils.createMultiMaterialObject(geometry53, multiMaterial );
		gem53.position.set(0, -50, -100);
		scene.add( gem53 );

	var geometry54 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem54 = THREE.SceneUtils.createMultiMaterialObject(geometry54, multiMaterial );
		gem54.position.set(100, -50, -100);
		scene.add( gem54 );

	var geometry55 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem55 = THREE.SceneUtils.createMultiMaterialObject(geometry55, multiMaterial );
		gem55.position.set(200, -50, -100);
		scene.add( gem55 );

	//3rd-row
	var geometry56 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem56 = THREE.SceneUtils.createMultiMaterialObject(geometry56, multiMaterial );
		gem56.position.set(-200, -50, -200);
		scene.add( gem56 );

	var geometry57 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem57 = THREE.SceneUtils.createMultiMaterialObject(geometry57, multiMaterial );
		gem57.position.set(-100, -50, -200);
		scene.add( gem57 );

	var geometry58 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem58 = THREE.SceneUtils.createMultiMaterialObject(geometry58, multiMaterial );
		gem58.position.set(0, -50, -200);
		scene.add( gem58 );

	var geometry59 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem59 = THREE.SceneUtils.createMultiMaterialObject(geometry59, multiMaterial );
		gem59.position.set(100, -50, -200);
		scene.add( gem59 );

	var geometry60 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem60 = THREE.SceneUtils.createMultiMaterialObject(geometry60, multiMaterial );
		gem60.position.set(200, -50, -200);
		scene.add( gem60 );

		//Top rows//
		//row 1
	var geometry26 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem26 = THREE.SceneUtils.createMultiMaterialObject(geometry26, multiMaterial );
		gem26.position.set(-200, 150, 100);
		scene.add( gem26 );

	var geometry27 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem27 = THREE.SceneUtils.createMultiMaterialObject(geometry27, multiMaterial );
		gem27.position.set(-100, 150, 100);
		scene.add( gem27 );

	var geometry28 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem28 = THREE.SceneUtils.createMultiMaterialObject(geometry28, multiMaterial );
		gem28.position.set(0, 150, 100);
		scene.add( gem28 );

	var geometry29 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem29 = THREE.SceneUtils.createMultiMaterialObject(geometry29, multiMaterial );
		gem29.position.set(100, 150, 100);
		scene.add( gem29 );

	var geometry30 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem30 = THREE.SceneUtils.createMultiMaterialObject(geometry30, multiMaterial );
		gem30.position.set(200, 150, 100);
		scene.add( gem30 );

	// row 2
	var geometry31 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem31 = THREE.SceneUtils.createMultiMaterialObject(geometry31, multiMaterial );
		gem31.position.set(-200, 150, 0);
		scene.add( gem31 );

	var geometry32 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem32 = THREE.SceneUtils.createMultiMaterialObject(geometry32, multiMaterial );
		gem32.position.set(-100, 150, 0);
		scene.add( gem32 );

	var geometry33 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem33 = THREE.SceneUtils.createMultiMaterialObject(geometry33, multiMaterial );
		gem33.position.set(0, 150, 0);
		scene.add( gem33 );

	var geometry34 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem34 = THREE.SceneUtils.createMultiMaterialObject(geometry34, multiMaterial );
		gem34.position.set(100, 150, 0);
		scene.add( gem34 );

	var geometry35 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem35 = THREE.SceneUtils.createMultiMaterialObject(geometry35, multiMaterial );
		gem35.position.set(200, 150, 0);
		scene.add( gem35 );

	// row 3
	var geometry36 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem36 = THREE.SceneUtils.createMultiMaterialObject(geometry36, multiMaterial );
		gem36.position.set(-200, 150, -100);
		scene.add( gem36 );

	var geometry37 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem37 = THREE.SceneUtils.createMultiMaterialObject(geometry37, multiMaterial );
		gem37.position.set(-100, 150, -100);
		scene.add( gem37 );

	var geometry38 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem38 = THREE.SceneUtils.createMultiMaterialObject(geometry38, multiMaterial );
		gem38.position.set(0, 150, -100);
		scene.add( gem38 );

	var geometry39 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem39 = THREE.SceneUtils.createMultiMaterialObject(geometry39, multiMaterial );
		gem39.position.set(100, 150, -100);
		scene.add( gem39 );

	var geometry40 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem40 = THREE.SceneUtils.createMultiMaterialObject(geometry40, multiMaterial );
		gem40.position.set(200, 150, -100);
		scene.add( gem40 );

	// row 4
	var geometry41 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem41 = THREE.SceneUtils.createMultiMaterialObject(geometry41, multiMaterial );
		gem41.position.set(-200, 150, -200);
		scene.add( gem41 );

	var geometry42 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem42 = THREE.SceneUtils.createMultiMaterialObject(geometry42, multiMaterial );
		gem42.position.set(-100, 150, -200);
		scene.add( gem42 );

	var geometry43 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem43 = THREE.SceneUtils.createMultiMaterialObject(geometry43, multiMaterial );
		gem43.position.set(0, 150, -200);
		scene.add( gem43 );

	var geometry44 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem44 = THREE.SceneUtils.createMultiMaterialObject(geometry44, multiMaterial );
		gem44.position.set(100, 150, -200);
		scene.add( gem44 );

	var geometry45 = new THREE.TetrahedronGeometry( 40, 1 )
		var gem45 = THREE.SceneUtils.createMultiMaterialObject(geometry45, multiMaterial );
		gem45.position.set(200, 150, -200);
		scene.add( gem45 );

	var gems = [gem1, gem2, gem3, gem4, gem5, gem6, gem7, gem8, gem9, gem10, gem11, gem12, gem13, gem14, gem15,
							gem16, gem17, gem18, gem19, gem20, gem21, gem22, gem23, gem24, gem25, gem26, gem27, gem28, gem29,
							 gem30, gem31, gem32, gem33, gem34, gem35, gem36, gem37, gem38, gem39, gem40, gem41, gem42, gem43,
							gem44, gem45, gem46, gem47, gem48, gem49, gem50, gem51, gem52, gem53, gem54, gem55,
							gem56, gem57, gem58, gem59, gem60 ];
	var selectedGem = gem1
	var outlineMaterial = new THREE.MeshBasicMaterial( { color: 0x00ff00, side: THREE.BackSide } );
	var outlineMesh = new THREE.Mesh( geometry1, outlineMaterial );
	outlineMesh.scale.multiplyScalar(1.05);

	function selectGem() {
		selectedGem = gems[Math.floor(Math.random() * gems.length)];
		outlineMesh.position = selectedGem.position;
		scene.add( outlineMesh );
	}
	selectGem();

	function removeOutline(meshOutline) {
		scene.remove (meshOutline)
	}

	//keeps score
	var scorePerMinute;
	var displayNumber;
	function addScore(scorePerMinute){
		displayNumber   = new THREEx.Text(scorePerMinute, {
			font        : "droid serif",
			weight      : "bold",
			size        : 50,
			height      : 10,
		})
	displayNumber.position.set(-270, 150, 100);
	scene.add(displayNumber)

	var perMinute   = new THREEx.Text("Per Minute", {
			font        : "droid serif",
			weight      : "bold",
			size        : 10,
			height      : 10,
		})
	perMinute.position.set(-270, 100, 100);
	scene.add(perMinute)
};
addScore(score);

//click-action
domEvents.addEventListener(outlineMesh, 'click', function(event){
	removeOutline(outlineMesh);
	selectGem();
	score += 1;
	scoring(score)
	scene.remove (displayNumber);
	addScore(scorePerMinute);
	}, false);

	var startTime = new Date()/1000/60;

	function scoring(score){
		var currentTime = new Date()/1000/60;
		scorePerMinute = Math.round(score/(currentTime - startTime));
	}

}


function animate()
{
  requestAnimationFrame( animate );
	render();
	update();
}

function update()
{

	controls.update();
}

function render()
{
	renderer.render( scene, camera );
}

</script>

</body>
</html>
